\section{Evaluation Method}\label{Evaluation_Method}

In order to find our probing rate for run our experiments we worked with two testbeds we had access to. The first is a small setup in our office, the second is a testbed called Orbit Lab \cite{orbit2005}.

\subsection*{In-Office Lab}

The In-office lab was mainly used to work on finding the probing rate at which the test in Orbit lab testbed were going to be conducted. The setup at our office is primarily composed by the following components.

\begin{enumerate}
	\item Raspberry Pi 3 running Raspbian GNU/Linux 8 (Jessie)
	\item Wireless Access Point TP-Link AC1750
	\item Dell Laptop Inspiron running Ubuntu 16.04.4 LTS (Xenial Xerus)
\end{enumerate}

The wireless card driver on the Dell Laptop supported 802.11 a/b/g/n/ac. The driver is \textit{iwlwifi} version 4.4.0-130-generic and firmware=17.948900127.0. At the In-Office lab we setup our deployment as illustrated in figure \ref{image:In_Office_Lab_Deployment}.

\begin{figure}[h]
	\centering
	\includegraphics[width=8cm]{Deployment/In_Office_Lab}
	\caption{In-Office Lab Deployment}
	\label{image:In_Office_Lab_Deployment}
\end{figure}

The Pi was the device from which the Pings were sent towards the Laptop. As illustrated in figure \ref{image:In_Office_Lab_Deployment} the Pi and access point were connected via Ethernet. The laptop was connected with the AP via 802.11n. Throughout the tests at the In-lab office we switched between 2.4 and 5.0 GHz band depending on the goal of the experiment. The In-Office lab played a key role to test the features we included in our GoPing tool prior to running experiment at Orbit lab testbed.

\subsection*{Orbit Lab}

The second testbed we worked with was Orbit Lab \cite{orbit2005}. Orbit lab can be considered a large testbed in which different Wireless technologies can be tested. One of these Wireless technologies is 802.11. Within Orbit Lab we worked with Sandbox 4 (SB4) which includes features to vary the attenuation between the nodes in the Sandbox. The main components of SB4 we worked with are the followings.

\begin{enumerate}
	\item SB4 has 9 nodes, each one of them runs Ubuntu 12.04
	\item Attenuation Controller which makes possible to vary the attenuation between the nodes.
\end{enumerate}

Each of the nodes has an Atheros Wireless card, the models are Atheros 5K and 9K. The nodes we worked with have Atheros chipsets which allowed us to collect detailed logs. The links between the nodes in SB4 can be set to attenuation values between 0-30 dBm from the attenuation controller. The topology of SB4 depends on the attenuation values for each link. For example a full-mesh topology is achieved when the attenuation value for all the links is set to 0 dBm. The feature of setting different attenuation values allowed us to test two scenarios associated to WiFi issues. The main deployment we worked with is a replica of the deployment we setup the In-office lab. The node working as AP was setup using the \emph{hostapd} utility. The WLAN settings for the AP are summarized in table \ref{table:WLAN_Settings_AP_Node}.

\begin{table}[h]
	\begin{center}
		\begin{tabular}{||c c||}
			\hline
			Setting & Value\\ [0.5ex] 
			\hline\hline
			802.11 Protocol & 802.11n\\ 
			\hline
			Channel Bonding & No\\
			\hline
			Band & 2.4 GHz\\
			\hline
			Security & Open\\ [1ex] 
			\hline
		\end{tabular}
	\end{center}
\caption{WLAN Settings at AP Node}
\label{table:WLAN_Settings_AP_Node}
\end{table} 


\subsection*{Experiments Setup}

In order to trigger WiFi and non-WiFi issues we setup three main scenarios in Orbit SB4 testbed. Two of them were associated to WiFi issues, attenuation and congestion. The third one was an issue at the access link. Across the three scenarios logging, GoPing, Wireless capture and iPerf measurement are similar. Our experiment sessions lasted for 10 min. During the session we collected Wireless stats logs every 10 secs at the AP and Wireless client. We also setup a Wireless a Sniffer to obtain Over-the-Air packet captures. From the wired client we sent the pings towards the AP and log the stats from GoPing. For the throughput measurement with iPerf, we setup iPerf server at the wireless node and the iPerf client at the wired node. iPerf was setup in TCP mode with 4 parallel TCP streams. We chose TCP as it is transport protocol most commonly used by services at Home WiFi networks. We decided to work with 4 parallel streams as within a Home WiFi the number of TCP in average is below 5 TCP streams \textbf{[We need a reference here]}.

\subsection*{Attenuation}

To trigger attenuation impairments in the testbed we varied the attenuation at the link between the wireless client and the access point. The deployment we worked with derived from the one illustrated in figure \ref{image:In_Office_Lab_Deployment}.  The only additional component is the node working as a wireless sniffer. The attenuation issue was triggered in third and ninth minute of the 10 min session. The experiment was designed this way to set a comparison between non-issue and issue conditions. We setup 5 scenarios with an increase of 3 dBm per impairment interval. Table \ref{table:Attenuation_Experiment_Values} breakdowns the scenarios and the attenuation levels for each impairment interval. Each one of the experiments was run 5 times.

\begin{table}[h!]
	\begin{center}
		\begin{tabular}{|| m{5em} | m{2cm}| m{2cm} ||}
			\hline
			\multirow{2}{*}{Scenario} & \multicolumn{2}{c||}{Attenuation Value {[}dBm{]}} \\ \cline{2-3} 
			& \multicolumn{1}{l|}{1st Interval} & \multicolumn{1}{l||}{2nd Interval} \\ \hline\hline
			1 & 3 & 6 \\ \hline
			2 & 9 & 12 \\ \hline
			3 & 15 & 18 \\ \hline
			4 & 21 & 24 \\ \hline
			5 & 27 & 30 \\ \hline
		\end{tabular}
	\end{center}
	\caption{Attenuation Scenarios and Values}
	\label{table:Attenuation_Experiment_Values}
\end{table}

\subsection*{Congestion}

To trigger congestion in our testbed, we connected more wireless nodes to the same AP our main wireless client was connecting to. At the 4th and 8th minute we connected an additional wireless node to the AP. The additional wireless node client sent iPerf UDP traffic to the AP, hence the AP was running an iPerf server instance. We increased by one the wireless nodes connected to the AP by one per issue interval. Table \ref{table:Congestion_Experiment_Values} consolidates the scenarios and number of wireless nodes connected to the AP.

\begin{table}[h!]
	\begin{center}
		\begin{tabular}{|| m{5em} | m{2cm}| m{2cm} ||}
			\hline
			\multirow{2}{*}{Scenario} & \multicolumn{2}{l||}{Connected Wireless Nodes} \\ \cline{2-3} 
			& \multicolumn{1}{l|}{1st Interval} & \multicolumn{1}{l||}{2nd Interval} \\ \hline\hline
			1 & 1 & 1 \\ \hline
			2 & 2 & 2 \\ \hline
			3 & 3 & 3 \\ \hline
			4 & 4 & 4 \\ \hline
			5 & 5 & 5 \\ \hline
		\end{tabular}
	\end{center}
	\caption{Congestion Scenarios and Values}
	\label{table:Congestion_Experiment_Values}
\end{table}

\subsection*{Access Link Limiting}

The third scenario experimented in the testbed was a non-WiFi issue. The issue consisted in limiting the access link capacity at the Wired node. We achieved limiting at the wired node by using \emph{tc} which is a traffic shaper. In a similar way to the attenuation scenario, we triggered the issue at the 3rd and 9th minute of the 10 min experiment window. Table \ref{table:Access_Link_Experiment_Values} details the scenarios and values used for the Access Link Limiting scenario.

\begin{table}[h!]
	\begin{center}
		\begin{tabular}{|| m{5em} | m{2cm}| m{2cm} ||}
			\hline
			\multirow{2}{*}{Scenario} & \multicolumn{2}{c||}{Throughput {[}Mbps{]}} \\ \cline{2-3} 
			& \multicolumn{1}{l|}{1st Interval} & \multicolumn{1}{l||}{2nd Interval} \\ \hline\hline
			1 & 100 & 90 \\ \hline
			2 & 80 & 70 \\ \hline
			3 & 60 & 50 \\ \hline
			4 & 40 & 30 \\ \hline
			5 & 20 & 10 \\ \hline
		\end{tabular}
	\end{center}
	\caption{Access Link Limiting Scenarios and Values}
	\label{table:Access_Link_Experiment_Values}
\end{table}

\subsection{RSSI in the wild}

With regards to the attenuation scenario we ran a survey to find the common RSSI value in home and office environment. We asked the colleagues at our office to run a script on their laptops. From the 760 samples collected we extracted the RSSI and found the most common values. We found the most common RSSI value from our survey ranged between -60 and - 65 dBm. Figure \ref{fig:RSSI_Histogram} illustrates the RSSI histogram of our survey.

\begin{figure}[h]
	\centering
	\includegraphics[width=8cm]{RSSI_Stats/RSSI_Histogram}
	\caption{RSSI Survey Values Histogram}
	\label{fig:RSSI_Histogram}
\end{figure}

The main goal of this exercise was to validate attenuation values to be used which led to the similar RSSI values in our testbed . In the SB4 testbed we worked with attenuation values of 0, 3 and 6 [dBm] led to RSSI values between -60 and -65 dBm. These values are included in the attenuation scenarios we worked with.



