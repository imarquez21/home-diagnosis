import numpy as np
import matplotlib.pyplot as plt
import sys
import os


def compute_CDF(RTTs_array):
    xvals = np.sort(RTTs_array)
    yvals = np.arange(len(xvals)) / float(len(xvals) - 1)

    return xvals,yvals

figs_path = "./Figures/"
fig1 = plt.figure(1)
#rate = str(sys.argv[1])
#samples_path = "./SampleFiles/"
samples_path = str(sys.argv[1])
figure_name = str(sys.argv[2])


print "Computing CDFs for samples located in "+samples_path+" folder."

cont = 0
for existing_file in sorted(os.listdir(samples_path)):
    sample_file = os.path.join(samples_path,existing_file)
    sample = np.loadtxt(sample_file, dtype=float, usecols=1)

    print "Computing CDF for file: "+existing_file
    sample_x, sample_y = compute_CDF(sample)
    
    print "Generating Plots"

    #If condition to match with the attenuation at which the log was taken
    if cont == 0:
        plt.plot(sample_x,sample_y,'.',label="0 dB")    
    elif cont == 1:
        plt.plot(sample_x,sample_y,'.',label="15 dB")
    elif cont == 2:
        plt.plot(sample_x,sample_y,'.',label="30 dB")
    #Remove commment from this line to have a autogenerated label for the lines
    #plotted in the figure
    #plt.plot(sample_x,sample_y,'.',label=str(cont)+" Test")

    print "\n"
    cont+=1

plt.title("ECDF - "+figure_name)
plt.xlabel("RTTs (msec)")
plt.ylabel("F(x)")
plt.grid()
plt.legend(loc='lower right')
print "Saving plots in "+figs_path+" folder."
plt.savefig(figs_path+figure_name+".png", dpi=300)
plt.show()
plt.close()

print "End of Script."


